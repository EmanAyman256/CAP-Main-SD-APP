sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast"],(e,t)=>{"use strict";return e.extend("invoice.controller.View1",{onInit:function(){var e=new sap.ui.model.json.JSONModel({DocumentNumber:"",SelectedItemNumber:"",ErrorMessage:"",documentItems:[]});this.getView().setModel(e)},onValueHelpRequest(e){if(!this._oValueHelpDialog){this._oValueHelpDialog=new sap.m.Dialog({title:"Select Debit Memo Number",content:[new sap.m.Table({id:this.createId("debitTable"),mode:"SingleSelectMaster",growing:true,growingThreshold:50,columns:[new sap.m.Column({header:new sap.m.Label({text:"Debit Memo Number"})}),new sap.m.Column({header:new sap.m.Label({text:"OverallOrdReltdBillgStatus"})}),new sap.m.Column({header:new sap.m.Label({text:"DebitMemoRequestType"})}),new sap.m.Column({header:new sap.m.Label({text:"SoldToParty"})})],items:{path:"/DebitMemo",parameters:{$count:true},template:new sap.m.ColumnListItem({type:"Active",cells:[new sap.m.Text({text:"{DebitMemoRequest}"}),new sap.m.Text({text:"{OverallOrdReltdBillgStatus}"}),new sap.m.Text({text:"{DebitMemoRequestType}"}),new sap.m.Text({text:"{SoldToParty}"})]}),events:{dataReceived:e=>{const t=e.getSource();const o=this.byId("debitTable");const s=o.getItems();const n=e.getParameter("data");console.log("Total items received:",s.length);console.log("Total count from server:",n?.__count||"N/A");if(s.length===0){sap.m.MessageBox.warning("No data found in Debit Memo.")}}}}})],beginButton:new sap.m.Button({text:"Confirm",press:e=>{const t=this.byId("debitTable");const o=t.getSelectedItem();if(o){const e=o.getCells()[0].getText();this.byId("debitmemoInput").setValue(e);this.getView().getModel().setProperty("/DocumentNumber",e);const t=this.getView().getModel().getProperty("/DocumentNumber");console.log(t);fetch(`/odata/v4/sales-cloud/findItemsByDebitMemoRequest?debitMemoRequest'${t}'`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{const t=JSON.parse(e.value);console.log("Parsed Value:",t);console.log("Items Value:",t.d.results);if(t&&t.d&&t.d.results){const e=t.d.results.map(e=>({DebitMemoRequestItem:e.DebitMemoRequestItem,DebitMemoRequestItemText:e.DebitMemoRequestItemText}));this.getView().getModel().setProperty("/documentItems",e);console.log("Stored documentItems:",e)}else{sap.m.MessageBox.warning("No items found in Debit Memo.")}}).catch(e=>{console.error("Error fetching items:",e);sap.m.MessageBox.error("Error: "+e.message)});this._oValueHelpDialog.close()}}}),endButton:new sap.m.Button({text:"Cancel",press:()=>{this._oValueHelpDialog.close()}})});var t=this.getOwnerComponent().getModel();this._oValueHelpDialog.setModel(t);this.getView().addDependent(this._oValueHelpDialog)}this._oValueHelpDialog.open()},onNextPress:function(){const e=this.getView();const o=e.getModel();const s=e.byId("_IDGenSelect").getSelectedKey();const n=o.getProperty("/DocumentNumber");if(!n){MessageBox.warning("Document Number is required.");return}if(!s){MessageBox.warning("Item Number is required.");return}o.setProperty("/ErrorMessage","");t.show("Navigating to next step with Doc: "+n+", Item: "+s);var a=sap.ui.core.UIComponent.getRouterFor(this);a.navTo("invoice",{docNumber:n,itemNumber:s})}})});
//# sourceMappingURL=View1.controller.js.map