sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/m/Dialog","sap/m/Input","sap/m/Button","sap/m/Label","sap/m/VBox","sap/ui/model/odata/v4/ODataModel"],function(e,t,r,o,i,s,n){"use strict";return e.extend("project1.controller.ServiceType",{onInit:function(){var e=new sap.ui.model.json.JSONModel({ServiceTypes:[],newCode:"",newDescription:""});this.getView().setModel(e,"view");fetch("./odata/v4/sales-cloud/ServiceTypes").then(e=>e.json()).then(t=>{e.setData({ServiceTypes:t.value});this.getView().byId("serviceTable").setModel(e)}).catch(e=>{console.error("Error fetching ServiceTypes",e)})},onAdd:function(){var e=this.getView().getModel();var t=e.getProperty("/newCode");var r=e.getProperty("/newDescription");if(t&&r){var o={serviceId:t,description:r};fetch("./odata/v4/sales-cloud/ServiceTypes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then(e=>{if(!e.ok){throw new Error("Failed to save: "+e.statusText)}return e.json()}).then(t=>{var r=e.getProperty("/ServiceTypes")||[];r.push(t);e.setProperty("/ServiceTypes",r);e.setProperty("/newCode","");e.setProperty("/newDescription","")}).catch(e=>{console.error("Error saving ServiceType:",e);sap.m.MessageBox.error("Error: "+e.message)})}else{sap.m.MessageBox.warning("Please fill in Code and Description.")}},onEdit:function(e){var a=e.getSource();var d=a.getParent().getParent().getBindingContext();if(!d){t.warning("Error: Unable to retrieve row data");return}var c=d.getObject();var p=this.getView().getModel("view");if(!this._oEditDialog){this._oEditDialog=new r({title:"Edit Service Type",titleAlignment:"Center",contentWidth:"600px",content:new n({}),beginButton:new i({text:"Save",type:"Emphasized",press:()=>{var e=this._oEditDialog.getContent()[0].getContent();var t=e[1].getValue();var r=e[3].getValue();fetch(`./odata/v4/sales-cloud/ServiceTypes('${c.serviceTypeCode}')`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({serviceId:t,description:r})}).then(e=>{if(!e.ok){throw new Error("Failed to update: "+e.statusText)}return e.json()}).then(e=>{console.log(e);var t=p.getProperty("/ServiceTypes")||[];var r=t.findIndex(e=>e.serviceId===c.serviceId);if(r>-1){t[r]=e;p.setProperty("/ServiceTypes",t)}sap.m.MessageToast.show("Service Type updated successfully!");this._oEditDialog.close()}).catch(e=>{console.error("Error updating ServiceType:",e);sap.m.MessageBox.error("Error: "+e.message)})}}),endButton:new i({text:"Cancel",press:()=>this._oEditDialog.close()})});this.getView().addDependent(this._oEditDialog)}this._oEditDialog.removeAllContent();this._oEditDialog.addContent(new sap.ui.layout.form.SimpleForm({editable:true,layout:"ResponsiveGridLayout",content:[new s({text:"Code",design:"Bold"}),new o({value:c.serviceId}),new s({text:"Description",design:"Bold"}),new o({value:c.description})]}));this._oEditDialog.open()},onDelete:function(e){var r=e.getSource().getBindingContext();if(r){var o=r.getPath();var i=this.getView().getModel("view");var s=i.getProperty(o);t.confirm("Are you sure you want to delete "+s.serviceId+"?",{title:"Confirm Deletion",onClose:function(e){if(e===t.Action.OK){fetch(`./odata/v4/sales-cloud/ServiceTypes('${s.serviceTypeCode}')`,{method:"DELETE"}).then(e=>{if(!e.ok){throw new Error("Failed to delete: "+e.statusText)}var t=i.getProperty("/ServiceTypes");var r=t.findIndex(e=>e.serviceId===s.serviceId);if(r>-1){t.splice(r,1);i.setProperty("/ServiceTypes",t)}sap.m.MessageToast.show("Service Type deleted successfully!")}).catch(e=>{console.error("Error deleting ServiceType:",e);sap.m.MessageBox.error("Error: "+e.message)})}}})}},onOpenAddServiceTypeDialog:function(){var e=this.getView().getModel("view");var t=new r({title:"Add New Service Type",content:new sap.ui.layout.form.SimpleForm({editable:true,layout:"ResponsiveGridLayout",content:[new s({text:"Code",design:"Bold"}),new o({value:"{view>/newCode}",placeholder:"Enter Code"}),new s({text:"Description",design:"Bold"}),new o({value:"{view>/newDescription}",placeholder:"Enter Description"})]}),beginButton:new i({text:"Add",press:function(){var r=e.getProperty("/newCode");var o=e.getProperty("/newDescription");console.log("Entered values:",r,o);if(r&&o){var i={serviceId:r,description:o};fetch("./odata/v4/sales-cloud/ServiceTypes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then(e=>{if(!e.ok){throw new Error("Failed to save: "+e.statusText)}return e.json()}).then(r=>{var o=e.getProperty("/ServiceTypes")||[];o.push(r);e.setProperty("/ServiceTypes",o);e.setProperty("/newCode","");e.setProperty("/newDescription","");sap.m.MessageToast.show("Service Type added successfully!");var i=this.byId("serviceTable");i.getBinding("items").refresh();t.close()}).catch(e=>{console.error("Error saving ServiceType:",e);sap.m.MessageBox.error("Error: "+e.message)})}else{sap.m.MessageBox.warning("Please fill in Code and Description.")}}.bind(this)}),endButton:new i({text:"Cancel",press:function(){e.setProperty("/newCode","");e.setProperty("/newDescription","");t.close()}}),afterClose:function(){t.destroy()}});t.setModel(e,"view");t.open()}})});
//# sourceMappingURL=ServiceType.controller.js.map