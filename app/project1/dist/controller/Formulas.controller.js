sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/m/Dialog","sap/m/Input","sap/m/Button","sap/m/Label","sap/m/VBox","sap/ui/model/json/JSONModel"],function(e,t,o,a,s,r,l,n){"use strict";return e.extend("project1.controller.Formulas",{onInit:function(){this.getOwnerComponent().getRouter().getRoute("formulas").attachPatternMatched(this._onRouteMatched,this);var e=new sap.ui.model.json.JSONModel({Formulas:[]});this.getView().setModel(e,"view");var e=new n;fetch("./odata/v4/sales-cloud/Formulas").then(e=>e.json()).then(t=>{e.setData({Formulas:t.value});this.getView().byId("formulasTable").setModel(e)}).catch(e=>{console.error("Error fetching formulas",e)})},_onRouteMatched:function(){this._loadFormulas()},_loadFormulas:function(){var e=new sap.ui.model.json.JSONModel;fetch("./odata/v4/sales-cloud/Formulas").then(e=>e.json()).then(t=>{e.setData({Formulas:t.value});this.getView().byId("formulasTable").setModel(e)}).catch(e=>{console.error("Error fetching formulas",e)})},onNavigateToAddFormula(){this.getOwnerComponent().getRouter().navTo("formula")},onDetails:function(e){var t=e.getSource().getBindingContext();if(!t){return}var o=t.getObject();var a=new sap.ui.model.json.JSONModel({FormulaCode:o.formula,Description:o.description,NumberOfParameters:o.numberOfParameters,Relation:o.formulaLogic});if(!this._oDetailsDialog){this._oDetailsDialog=new sap.m.Dialog({title:"Formula Details",content:new sap.ui.layout.form.SimpleForm({editable:false,content:[new sap.m.Label({text:"Formula Code:"}),new sap.m.Text({text:"{/FormulaCode}"}),new sap.m.Label({text:"Description:"}),new sap.m.Text({text:"{/Description}"}),new sap.m.Label({text:"NumberOfParameters:"}),new sap.m.Text({text:"{/NumberOfParameters}"}),new sap.m.Label({text:"Relation:"}),new sap.m.Text({text:"{/Relation}"})]}),endButton:new sap.m.Button({text:"Ok",type:"Emphasized",press:function(){this._oDetailsDialog.close()}.bind(this)})});this.getView().addDependent(this._oDetailsDialog)}this._oDetailsDialog.setModel(a);this._oDetailsDialog.open()},onDelete:function(e){var o=e.getSource().getBindingContext();if(o){var a=o.getPath();var s=this.getView().byId("formulasTable").getModel();var r=s.getProperty(a);if(!r){sap.m.MessageBox.error("Could not find model data for deletion.");return}t.confirm("Are you sure you want to delete "+r.formula+"?",{title:"Confirm Deletion",onClose:function(e){if(e===t.Action.OK){fetch(`./odata/v4/sales-cloud/Formulas('${r.formulaCode}')`,{method:"DELETE"}).then(e=>{if(!e.ok){throw new Error("Failed to delete: "+e.statusText)}var t=s.getProperty("/Formulas");var o=t.findIndex(e=>e.formulaCode===r.formulaCode);if(o>-1){t.splice(o,1);s.setProperty("/Formulas",t)}sap.m.MessageToast.show("Formula deleted successfully!")}).catch(e=>{console.error("Error deleting Formula:",e);sap.m.MessageBox.error("Error: "+e.message)})}}})}}})});
//# sourceMappingURL=Formulas.controller.js.map